<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pill Dispenser</title>
    <style>
        /* Add your CSS styles here */
        .container {
            text-align: center;
            margin-top: 50px;
        }
        .button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            text-decoration: none;
        }
        #dispenseButton {
            display: none; /* Hide the button by default */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to the Pill Dispenser</h1>
        <a href="/add_pill" class="button">Add Pill</a>
        <a href="/schedule" class="button">View Schedule</a>
        <a href="/dispense" id="dispenseButton" class="button">Dispense Pills</a>
    </div>

    <script>
        // Function to fetch the scheduled time from the server-side route
        function fetchScheduledTimeAndShowButton() {
            fetch('/get_schedule')
            .then(response => response.text())
            .then(scheduledTime => {
                // Convert scheduled time to milliseconds
                var scheduledTimeMillis = Date.parse('01 Jan 1970 ' + scheduledTime) - (new Date()).getTimezoneOffset() * 60000;
                
                // Convert current time to milliseconds
                var currentTimeMillis = (new Date()).getTime();
                
                // Check if it's the scheduled time
                if (currentTimeMillis >= scheduledTimeMillis) {
                    document.getElementById('dispenseButton').style.display = 'block';
                }
            });
        }

        // Call the function when the page loads
        window.onload = fetchScheduledTimeAndShowButton;
    </script>
</body>
</html>


